use std::collections::HashMap;

pub fn sort_array(nums: Vec<i32>) -> Vec<i32> {
    let mut freq: HashMap<i32, i32> = HashMap::with_capacity(nums.len());
    if nums.is_empty() {
        return nums;
    }

    let mut result: Vec<i32> = vec![0; nums.len()];
    let mut max = nums[0];
    let mut min = nums[0];
    let mut index: usize = 0;
    for &num in &nums {
        freq.entry(num).and_modify(|x| *x += 1).or_insert(1);
        if max < num {
            max = num;
        }
        if min > num {
            min = num;
        }
    }
    for i in min..=max {
        if let Some(count) = freq.get_mut(&i) {
            while count > &mut 0 {
                *count -= 1;
                result[index] = i;
                index += 1;
            }
        }
    }
    result
}

#[cfg(test)]
mod tests {
    use super::sort_array;
    use rstest::rstest;
    #[rstest]
    #[case(&[5,1,1,2,0,0], &[0,0,1,1,2,5])]
    #[case(&[5,2,3,1], &[1,2,3,5])]
    #[case(&[1,2,3,4,5,6,7,8,9], &[1,2,3,4,5,6,7,8,9])]
    #[case(&[5,5,5,5], &[5,5,5,5])]
    #[case(&[1], &[1])]
    #[case(&[-1,0,1], &[-1,0,1])]
    #[case(&[7,7,7,7,7,7,7,7,7,7,7,7], &[7,7,7,7,7,7,7,7,7,7,7,7])]
    #[case(&[0,0,0,0,0,0,0,0,0,0], &[0,0,0,0,0,0,0,0,0,0])]
    #[case(&[-50000,50000,-49999,49999], &[-50000,-49999,49999,50000])]
    #[case(&[10,20,30,40,50,80,60,70,90,100,120,110], &[10,20,30,40,50,60,70,80,90,100,110,120])]
    #[case(&[100,90,80,70,60,50,40,30,20,10], &[10,20,30,40,50,60,70,80,90,100])]
    #[case(&[50000,49999,49998,-50000,-49999,-49998,0,1,-1,2,-2], &[-50000,-49999,-49998,-2,-1,0,1,2,49998,49999,50000])]
    #[case(&[-50000,-50000,-50000,-50000,-50000,50000,50000,50000,50000,50000], &[-50000,-50000,-50000,-50000,-50000,50000,50000,50000,50000,50000])]
    #[case(&[1,2,3,4,5,6,7,-1], &[-1,1,2,3,4,5,6,7])]
    #[case(&[1,2,3,4,5], &[1,2,3,4,5])]
    #[case(&[0,0,0,0,1,1,-1,-1,2,2,-2,-2,0,3,-3,3,-3,0,1,-1,2,-2,0], &[-3,-3,-2,-2,-2,-1,-1,-1,0,0,0,0,0,0,0,1,1,1,2,2,2,3,3])]
    #[case(&[4,-7,2,11,-3,0,9,5,-12,8,1,-6,3,-1,10,-4,7,13,-8,6,-2,12,-5,9], &[-12,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,9,10,11,12,13])]
    #[case(&[-42,17,99,-88,0,33,76,-15,61,23,-71,8,54,-29,92,-3,47,-66], &[-88,-71,-66,-42,-29,-15,-3,0,8,17,23,33,47,54,61,76,92,99])]
    #[case(&[50000,-50000,50000,-50000,0], &[-50000,-50000,0,50000,50000])]
    #[case(&[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1], &[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1])]
    #[case(&[-50000,50000,-50000,50000,-50000], &[-50000,-50000,-50000,50000,50000])]
    #[case(&[], &[])]
    #[case(&[-50000], &[-50000])]
    #[case(&[1,2,3,4,5,6,7,8,9], &[1,2,3,4,5,6,7,8,9])]
    #[case(&[5], &[5])]
    #[case(&[-4,-1,0,2,5], &[-4,-1,0,2,5])]
    #[case(&[10,8,6,4,2,1,3,5,7,9], &[1,2,3,4,5,6,7,8,9,10])]
    #[case(&[50000,-50000,0,49999,-49999], &[-50000,-49999,0,49999,50000])]
    #[case(&[-50000,50000,0,-49999,49999], &[-50000,-49999,0,49999,50000])]
    #[case(&[], &[])]
    #[case(&[1,2,3,4], &[1,2,3,4])]
    #[case(&[42], &[42])]
    #[case(&[], &[])]
    #[case(&[1], &[1])]
    #[case(&[-50000], &[-50000])]
    #[case(&[50000], &[50000])]
    #[case(&[7,7,7,7,7], &[7,7,7,7,7])]
    #[case(&[-1,0,1], &[-1,0,1])]
    #[case(&[4,-7,11,2,-3,0,9,5,-12,8], &[-12,-7,-3,0,2,4,5,8,9,11])]
    #[case(&[0,0,0,1,-1,2,-2,0], &[-2,-1,0,0,0,0,1,2])]
    #[case(&[1,2,3,4,5,6,7,8], &[1,2,3,4,5,6,7,8])]

    fn test_sort_array(#[case] nums: &[i32], #[case] expected: &[i32]) {
        assert_eq!(sort_array(nums.to_vec()), expected.to_vec());
    }
}
